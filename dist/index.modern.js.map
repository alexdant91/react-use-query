{"version":3,"file":"index.modern.jsx","sources":["../src/index.jsx"],"sourcesContent":["import { useState, useEffect, useRef, createContext, useContext, useCallback } from 'react';\n\n/**\n * @callback QueryResultCacheFn\n * @param {string} url\n * \n * @typedef {object} QueryResultCache\n * @property {QueryResultCacheFn} get\n * @property {QueryResultCacheFn} has\n * @property {QueryResultCacheFn} clear\n *\n * @typedef {object} QueryResult\n * @property {*} data\n * @property {Error|false} error\n * @property {boolean} loading\n * @property {function} updateData\n * @property {function} refresh\n * @property {QueryResultCache} cache\n *\n * @typedef {object} QueryEventResult\n * @property {function} sendRequest\n * @property {boolean} isSending\n * @property {*} data\n * @property {Error|false} error\n * @property {boolean} loading\n * @property {function} updateData\n * @property {function} refresh\n * @property {QueryResultCache} cache\n * \n * @typedef {object} DefaultUseQueryOptions\n * @property {string} [name] \n * @property {string} [selector] \n * @property {array|function} [pick]\n * @property {function} [transform] \n * @property {string} [method=\"GET\"] \n * @property {object} [headers] \n * @property {*} [body] \n * @property {boolean} [isDebuggerActivated=false] \n * @property {number} [cacheTimeout=0] \n */\n\nconst DEFAULT_OPTIONS = {\n    name: undefined,\n    selector: undefined,\n    transform: undefined,\n    pick: undefined,\n    method: \"GET\",\n    headers: undefined,\n    body: undefined,\n    isDebuggerActivated: false,\n    cacheTimeout: 0,\n};\n\nlet cacheTimeout = null;\n\n/**\n * @param {string} [message=\"\"] \n * @param {boolean} [isDebuggerActivated=false]\n * @param {boolean} [isError=false] \n * @param {null|string|Error} [error=null]\n */\nconst logDebugger = (message = \"\", isDebuggerActivated = false, isError = false, error = null) => {\n    if (isError) {\n        if (isDebuggerActivated) console.error(`[USE_QUERY]: ${message} - ${new Date().toLocaleTimeString()}`, error);\n    } else {\n        if (isDebuggerActivated) console.log(`[USE_QUERY]: ${message} - ${new Date().toLocaleTimeString()}`);\n    }\n}\n\n/**\n * @param {DefaultUseQueryOptions} options \n * @returns {boolean}\n */\nconst validateOptions = (options) => {\n    const keys = Object.keys(DEFAULT_OPTIONS);\n    const _keys = Object.keys(options);\n    const symDifference = _keys.filter(item => !keys.includes(item));\n\n    if (options.selector !== undefined && typeof options.selector !== \"string\") {\n        logDebugger(\"Validation error for `options.selector`\", isDebuggerActivated, true, new Error(\"Selector must be a string. It should contains key value to select from result object.\"));\n        return false;\n    } else if (options.name !== undefined && typeof options.name !== \"string\") {\n        logDebugger(\"Validation error for `options.name`\", isDebuggerActivated, true, new Error(\"Name must be a string. It should contains data name to retrieve it from state.\"));\n        return false;\n    } else if (options.method !== undefined && (typeof options.method !== \"string\" || [\"GET\", \"POST\", \"PUT\", \"PATCH\", \"DELETE\"].indexOf(options.method.toUpperCase()) === -1)) {\n        logDebugger(\"Validation error for `options.method`\", isDebuggerActivated, true, new Error('Method must be a string. It should be one of \"GET\", \"POST\", \"PUT\", \"PATCH\", \"DELETE\".'));\n        return false;\n    } else if (options.headers !== undefined && typeof options.headers !== \"object\" && Array.isArray(options.headers)) {\n        logDebugger(\"Validation error for `options.headers`\", isDebuggerActivated, true, new Error(\"Headers must be an object. It should contains request headers key value.\"));\n        return false;\n    } else if (options.isDebuggerActivated !== undefined && typeof options.isDebuggerActivated !== \"boolean\" && Array.isArray(options.headers)) {\n        logDebugger(\"Validation error for `options.isDebuggerActivated`\", true, true, new Error(\"isDebuggerActivated must be a boolean. It should be activated if you need to debug all process.\"));\n        return false;\n    } else if (options.transform !== undefined && typeof options.transform !== \"function\") {\n        logDebugger(\"Validation error for `options.transform`\", true, true, new Error(\"transform must be a function. It rappresent the function to transform data before saving on state.\"));\n        return false;\n    } else if (options.pick !== undefined && (typeof options.pick !== \"function\" && !Array.isArray(options.pick))) {\n        logDebugger(\"Validation error for `options.pick`\", true, true, new Error(\"pick must be a function or an array. It rappresent the function or the array to pick just a portion of data.\"));\n        return false;\n    } else if (options.cacheTimeout !== undefined && typeof options.cacheTimeout !== \"number\") {\n        logDebugger(\"Validation error for `options.cacheTimeout`\", true, true, new Error(\"cacheTimeout must be a number. It rappresent the timeout to remove cached data from memory in milliseconds.\"));\n        return false;\n    }\n    \n    if (symDifference.length > 0) {\n        logDebugger(\"Validation error\", true, true, new Error(`Found not valid option${symDifference.length > 1 ? \"s\" : \"\"}: \"${symDifference.join('\", \"')}\".`));\n        return false;\n    }\n\n    return true;\n}\n\n/**\n * @param {DefaultUseQueryOptions} options \n * @param {MutableRefObject} cache \n */\nconst timeoutCacheClear = (options, cache) => {\n    if (options.cacheTimeout && options.cacheTimeout > 0) {\n        logDebugger(`Cache clear timeout start: ${options.cacheTimeout / 1000} seconds.`, options.isDebuggerActivated);\n        clearTimeout(cacheTimeout);\n        cacheTimeout = setTimeout(() => {\n            cache.current = {};\n            logDebugger(`Cache cleared`, options.isDebuggerActivated);\n        }, options.cacheTimeout);\n    }\n}\n\nconst QueryContext = createContext(null);\n\nexport const QueryProvider = ({ children }) => {\n    const [state, setState] = useState(null);\n    return (\n        <QueryContext.Provider value={[state, setState]}>\n            {children}\n        </QueryContext.Provider>\n    )\n}\n\nexport const useQueryContext = (name = undefined) => {\n    const [data, setData] = useContext(QueryContext);\n    \n    if (name) { \n        return [data ? data[name] : data, (value) => setData((prev) => ({ ...prev, [name]: value }))];\n    } else {\n        return [data, setData];\n    }\n};\n\n/**\n * Use query hook that manage requests, cache and other features.\n * @param {string} url \n * @param {object} options\n * @param {string} [options.name] Name must be a string. It should contains data state name.\n * @param {string} [options.selector] Selector must be a string. It should contains key value to select from result object.\n * @param {string} [options.pick] Pick must be a function or an array of string. It rappresent the function or the array to pick just a portion of data.\n * @param {function} [options.transform] Transform must be a function. It rappresent the funcion to transform data before saving on state. If you need to mutate data, use `mutate` function instead\n * @param {string} [options.method] Method must be a string. It should be one of \"GET\", \"POST\", \"PUT\", \"PATCH\", \"DELETE\".\n * @param {object} [options.headers] Headers must be an object. It should contains request headers key value.\n * @param {*} [options.body]\n * @param {boolean} [options.isDebuggerActivated] isDebuggerActivated must be a boolean. It should be activated if you need to debug all process.\n * @param {number} [options.cacheTimeout] cacheTimeout must be a number. It rappresent the timeout to remove cached data from memory in milliseconds.\n * @returns {QueryResult}\n */\nexport const useQuery = (url, options = { ...DEFAULT_OPTIONS }) => {\n    const { name, selector, pick, transform, method, headers, body, isDebuggerActivated } = { ...DEFAULT_OPTIONS, ...options };\n\n    validateOptions({ ...DEFAULT_OPTIONS, ...options });\n    \n    const cache = useRef({});\n\n    const [data, setData] = useQueryContext(name);\n    const [error, setError] = useState(null);\n    const [loading, setLoading] = useState(false);\n\n    const fetchData = async () => {\n        logDebugger(\"Fetching data...\", isDebuggerActivated);\n\n        if (error) setError(null);\n        if (!loading) setLoading(true);\n\n        if (cache.current[url]) {\n            logDebugger(\"Get data from cache, no need a new request\", isDebuggerActivated);\n            if (typeof transform === \"function\") logDebugger(\"transform data before saving\", isDebuggerActivated);\n            if (typeof pick === \"function\" || Array.isArray(pick)) logDebugger(\"pick data before saving\", isDebuggerActivated);\n\n            setData(cache.current[url]);\n            timeoutCacheClear(options, cache);\n            setLoading(false);\n            return;\n        }\n\n        try {\n            logDebugger(\"No data found in cache, proceed to do a new request...\", isDebuggerActivated);\n\n            const response = await fetch(url, { method, headers, data: body });\n            const result = await response.json();\n\n            if (response.ok) {\n                const _result = selector ? result[selector] : result;\n                if (typeof transform === \"function\") logDebugger(\"transform data before saving\", isDebuggerActivated);\n                let _transformedData = typeof transform === \"function\" ? transform(_result) : _result;\n                if (typeof pick === \"function\" || Array.isArray(pick)) {\n                    logDebugger(\"pick data before saving\", isDebuggerActivated);\n                    _transformedData = JSON.parse(JSON.stringify(_transformedData, pick));\n                }\n                setData(_transformedData);\n                logDebugger(\"Request done\", isDebuggerActivated);\n                cache.current[url] = _transformedData;\n                timeoutCacheClear(options, cache);\n                logDebugger(`New data saved on cache for: \"${url}\"`, isDebuggerActivated);\n            } else {\n                setError(result);\n                logDebugger(\"An error occurred\", isDebuggerActivated, true, result);\n            }\n        } catch (err) {\n            setError(err);\n            logDebugger(\"An error occurred\", isDebuggerActivated, true, err);\n        } finally {\n            setLoading(false);\n            logDebugger(\"Data seatled, process done\", isDebuggerActivated);\n        }\n    };\n\n    useEffect (() => {\n        fetchData();\n    }, [url]);\n\n    return {\n        data,\n        error,\n        loading,\n        mutate: setData,\n        refresh: fetchData,\n        cache: {\n            get: (url) => {\n                return url ? cache.current[url] : cache.current;\n            },\n            has: (url) => {\n                return cache.current[url];\n            },\n            clear: () => {\n                cache.current = {};\n                logDebugger(`Cache cleared`, isDebuggerActivated);\n            }\n        }\n    };\n};\n\n/**\n * Use query hook that manage requests, cache and other features with an event like \"click\"\n * @param {string} url \n * @param {object} options\n * @param {string} [options.name] Name must be a string. It should contains data state name.\n * @param {string} [options.selector] Selector must be a string. It should contains key value to select from result object.\n * @param {string} [options.pick] Pick must be a function or an array of string. It rappresent the function or the array to pick just a portion of data.\n * @param {function} [options.transform] Transform must be a function. It rappresent the funcion to transform data before saving on state. If you need to mutate data, use `mutate` function instead\n * @param {string} [options.method] Method must be a string. It should be one of \"GET\", \"POST\", \"PUT\", \"PATCH\", \"DELETE\".\n * @param {object} [options.headers] Headers must be an object. It should contains request headers key value.\n * @param {*} [options.body]\n * @param {boolean} [options.isDebuggerActivated] isDebuggerActivated must be a boolean. It should be activated if you need to debug all process.\n * @param {number} [options.cacheTimeout] cacheTimeout must be a number. It rappresent the timeout to remove cached data from memory in milliseconds.\n * @returns {QueryEventResult}\n */\nexport const useQueryEvent = (url, options = { ...DEFAULT_OPTIONS }) => {\n    const [isSending, setIsSending] = useState(false);\n\n    const { name, selector, pick, transform, method, headers, body, isDebuggerActivated } = { ...DEFAULT_OPTIONS, ...options };\n\n    validateOptions({ ...DEFAULT_OPTIONS, ...options });\n    \n    const cache = useRef({});\n\n    const [data, setData] = useQueryContext(name);\n    const [error, setError] = useState(null);\n    const [loading, setLoading] = useState(false);\n\n    const fetchData = async () => {\n        logDebugger(\"Fetching data...\", isDebuggerActivated);\n\n        if (error) setError(null);\n        if (!loading) setLoading(true);\n\n        if (cache.current[url]) {\n            logDebugger(\"Get data from cache, no need a new request\", isDebuggerActivated);\n            if (typeof transform === \"function\") logDebugger(\"transform data before saving\", isDebuggerActivated);\n            if (typeof pick === \"function\" || Array.isArray(pick)) logDebugger(\"pick data before saving\", isDebuggerActivated);\n\n            setData(cache.current[url]);\n            timeoutCacheClear(options, cache);\n            setLoading(false);\n            return;\n        }\n\n        try {\n            logDebugger(\"No data found in cache, proceed to do a new request...\", isDebuggerActivated);\n\n            const response = await fetch(url, { method, headers, data: body });\n            const result = await response.json();\n\n            if (response.ok) {\n                const _result = selector ? result[selector] : result;\n                if (typeof transform === \"function\") logDebugger(\"transform data before saving\", isDebuggerActivated);\n                let _transformedData = typeof transform === \"function\" ? transform(_result) : _result;\n                if (typeof pick === \"function\" || Array.isArray(pick)) {\n                    logDebugger(\"pick data before saving\", isDebuggerActivated);\n                    _transformedData = JSON.parse(JSON.stringify(_transformedData, pick));\n                }\n                setData(_transformedData);\n                logDebugger(\"Request done\", isDebuggerActivated);\n                cache.current[url] = _transformedData;\n                timeoutCacheClear(options, cache);\n                logDebugger(`New data saved on cache for: \"${url}\"`, isDebuggerActivated);\n            } else {\n                setError(result);\n                logDebugger(\"An error occurred\", isDebuggerActivated, true, result);\n            }\n        } catch (err) {\n            setError(err);\n            logDebugger(\"An error occurred\", isDebuggerActivated, true, err);\n        } finally {\n            setLoading(false);\n            logDebugger(\"Data seatled, process done\", isDebuggerActivated);\n        }\n    };\n  \n    const sendRequest = useCallback(async () => {\n      // don't send again while we are sending\n      if (isSending) return\n      // update state\n      setIsSending(true);\n      // send the actual request\n      await fetchData();\n      // once the request is sent, update state again\n      setIsSending(false);\n    }, [isSending, url]) // update the callback if the state changes\n  \n    return {\n        sendRequest,\n        isSending,\n        data,\n        error,\n        loading,\n        mutate: setData,\n        refresh: fetchData,\n        cache: {\n            get: (url) => {\n                return url ? cache.current[url] : cache.current;\n            },\n            has: (url) => {\n                return cache.current[url];\n            },\n            clear: () => {\n                cache.current = {};\n                logDebugger(`Cache cleared`, isDebuggerActivated);\n            }\n        }\n    }\n  }"],"names":["DEFAULT_OPTIONS","name","undefined","selector","transform","pick","method","headers","body","isDebuggerActivated","cacheTimeout","logDebugger","message","isError","error","console","Date","toLocaleTimeString","log","validateOptions","options","keys","Object","_keys","symDifference","filter","item","includes","Error","indexOf","toUpperCase","Array","isArray","length","join","timeoutCacheClear","cache","clearTimeout","setTimeout","current","QueryContext","createContext","QueryProvider","children","state","setState","useState","_jsx","Provider","value","useQueryContext","data","setData","useContext","prev","_extends","useQuery","url","useRef","setError","loading","setLoading","fetchData","response","fetch","result","json","ok","_result","_transformedData","JSON","parse","stringify","err","useEffect","mutate","refresh","get","has","clear","useQueryEvent","isSending","setIsSending","sendRequest","useCallback"],"mappings":"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"}